{% liquid
  assign heading = section.settings.heading
%}

<div class="featured-collections-three" style="
  padding-top: {{ section.settings.padding_top }}px;
  padding-bottom: {{ section.settings.padding_bottom }}px;
  background-color: {{ section.settings.background_color }};
">
  <div class="page-width" style="
    max-width: {{ section.settings.container_width }}px;
    margin: 0 auto;
    padding: 0 {{ section.settings.container_padding }}px;
  ">
    
    {% if section.settings.show_heading %}
      <h2 style="
        text-align: {{ section.settings.heading_alignment }};
        font-size: {{ section.settings.heading_size }}px;
        color: {{ section.settings.heading_color }};
        font-weight: {{ section.settings.heading_weight }};
        text-transform: {{ section.settings.heading_transform }};
        letter-spacing: {{ section.settings.heading_letter_spacing }}px;
        margin-bottom: {{ section.settings.heading_spacing }}px;
      ">
        {{ heading }}
      </h2>
    {% endif %}

    <div class="collections-grid" style="
      display: grid;
      grid-template-columns: repeat({{ section.settings.columns_desktop }}, 1fr);
      gap: {{ section.settings.grid_gap }}px;
    ">
      {% for block in section.blocks %}
        <div class="collection-item" {{ block.shopify_attributes }} style="transition: transform 0.3s ease;">
          {% if block.settings.collection %}
            <a href="{{ block.settings.collection.url }}" style="text-decoration: none; color: inherit; display: block;">
          {% endif %}
          
          {% if block.settings.image %}
            <div class="collection-image-wrapper" style="
              aspect-ratio: {{ section.settings.image_ratio }};
              overflow: hidden;
              border-radius: {{ section.settings.image_border_radius }}px;
              margin-bottom: {{ section.settings.image_spacing }}px;
            ">
              <img 
                src="{{ block.settings.image | image_url: width: 1000 }}"
                alt="{{ block.settings.image.alt | escape }}"
                style="transition: transform 0.4s ease;"
                loading="lazy"
                style="
                  width: 100%;
                  height: 100%;
                  object-fit: {{ section.settings.image_fit }};
                  object-position: {{ section.settings.image_position }};
                  transition: transform {{ section.settings.hover_zoom_duration }}s ease;
                "
                {% if section.settings.enable_hover_zoom %}
                  onmouseover="this.style.transform='scale({{ section.settings.hover_zoom_scale }})'"
                  onmouseout="this.style.transform='scale(1)'"
                {% endif %}
              >
            </div>
          {% else %}
            <div class="collection-placeholder" style="
              aspect-ratio: {{ section.settings.image_ratio }};
              background-color: #f5f5f5;
              border-radius: {{ section.settings.image_border_radius }}px;
              margin-bottom: {{ section.settings.image_spacing }}px;
              display: flex;
              align-items: center;
              justify-content: center;
            ">
              {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {% endif %}

          {% if block.settings.text != blank %}
            <div class="collection-text" style="
              font-size: {{ section.settings.text_size }}px;
              color: {{ section.settings.text_color }};
              font-weight: {{ section.settings.text_weight }};
              text-align: {{ section.settings.text_alignment }};
              text-transform: {{ section.settings.text_transform }};
              margin-top: {{ section.settings.text_spacing }}px;
            ">
              {{ block.settings.text }}
            </div>
          {% endif %}
          
          {% if block.settings.collection %}
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  .featured-collections-three h2 {
    font-size: {{ section.settings.heading_size }}px;
  }
  
  @media screen and (max-width: 989px) {
    .collections-grid {
      grid-template-columns: repeat({{ section.settings.columns_tablet }}, 1fr) !important;
      gap: {{ section.settings.grid_gap | divided_by: 1.5 }}px !important;
    }
    
    .featured-collections-three h2 {
      font-size: {{ section.settings.heading_size | times: 0.75 }}px !important;
      margin-bottom: {{ section.settings.heading_spacing | divided_by: 1.5 }}px !important;
    }
    
    .featured-collections-three {
      padding-top: {{ section.settings.padding_top | divided_by: 1.5 }}px !important;
      padding-bottom: {{ section.settings.padding_bottom | divided_by: 1.5 }}px !important;
    }
  }
  
  @media screen and (max-width: 749px) {
    .collections-grid {
      grid-template-columns: repeat({{ section.settings.columns_mobile }}, 1fr) !important;
      gap: {{ section.settings.grid_gap | divided_by: 2 }}px !important;
    }
    
    .featured-collections-three h2 {
      font-size: {{ section.settings.heading_size | times: 0.6 }}px !important;
      margin-bottom: {{ section.settings.heading_spacing | divided_by: 2 }}px !important;
    }
    
    .featured-collections-three {
      padding-top: {{ section.settings.padding_top | divided_by: 2 }}px !important;
      padding-bottom: {{ section.settings.padding_bottom | divided_by: 2 }}px !important;
    }
    
    .page-width {
      padding: 0 {{ section.settings.container_padding | divided_by: 2 }}px !important;
    }
    
    .collection-text {
      font-size: {{ section.settings.text_size | times: 0.875 }}px !important;
    }
  }
</style>

{% schema %}
{
  "name": "3 Collections",
  "settings": [
    {
      "type": "header",
      "content": "Heading"
    },
    {
      "type": "checkbox",
      "id": "show_heading",
      "default": true,
      "label": "Show heading"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading text",
      "default": "Featured Collections"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "Heading alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 80,
      "step": 2,
      "default": 36,
      "label": "Heading size",
      "unit": "px"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "heading_weight",
      "label": "Heading weight",
      "options": [
        { "value": "300", "label": "Light" },
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },
    {
      "type": "select",
      "id": "heading_transform",
      "label": "Text transform",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "uppercase", "label": "Uppercase" },
        { "value": "lowercase", "label": "Lowercase" },
        { "value": "capitalize", "label": "Capitalize" }
      ],
      "default": "none"
    },
    {
      "type": "range",
      "id": "heading_letter_spacing",
      "min": -2,
      "max": 10,
      "step": 0.5,
      "default": 0,
      "label": "Letter spacing",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "heading_spacing",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40,
      "label": "Bottom spacing",
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 60,
      "label": "Padding top",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 5,
      "default": 60,
      "label": "Padding bottom",
      "unit": "px"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "container_width",
      "min": 1000,
      "max": 2000,
      "step": 50,
      "default": 1400,
      "label": "Container width",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "container_padding",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 20,
      "label": "Side padding",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 30,
      "label": "Gap between items",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 4,
      "label": "Columns (Desktop)"
    },
    {
      "type": "range",
      "id": "columns_tablet",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 4,
      "label": "Columns (Tablet)"
    },
    {
      "type": "range",
      "id": "columns_mobile",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 1,
      "label": "Columns (Mobile)"
    },
    {
      "type": "header",
      "content": "Image Settings"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "label": "Image aspect ratio",
      "options": [
        { "value": "1/1", "label": "Square (1:1)" },
        { "value": "4/5", "label": "Portrait (4:5)" },
        { "value": "3/4", "label": "Portrait (3:4)" },
        { "value": "2/3", "label": "Portrait (2:3)" },
        { "value": "9/16", "label": "Portrait (9:16)" },
        { "value": "16/9", "label": "Landscape (16:9)" },
        { "value": "5/4", "label": "Landscape (5:4)" }
      ],
      "default": "4/5"
    },
    {
      "type": "select",
      "id": "image_fit",
      "label": "Image fit",
      "options": [
        { "value": "cover", "label": "Cover" },
        { "value": "contain", "label": "Contain" },
        { "value": "fill", "label": "Fill" }
      ],
      "default": "cover"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image position",
      "options": [
        { "value": "center", "label": "Center" },
        { "value": "top", "label": "Top" },
        { "value": "bottom", "label": "Bottom" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "image_border_radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "default": 0,
      "label": "Border radius",
      "unit": "px"
    },
    {
      "type": "range",
      "id": "image_spacing",
      "min": 0,
      "max": 50,
      "step": 2,
      "default": 16,
      "label": "Bottom spacing",
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "enable_hover_zoom",
      "default": true,
      "label": "Enable hover zoom"
    },
    {
      "type": "range",
      "id": "hover_zoom_scale",
      "min": 1.0,
      "max": 1.5,
      "step": 0.1,
      "default": 1.1,
      "label": "Zoom scale"
    },
    {
      "type": "range",
      "id": "hover_zoom_duration",
      "min": 0.1,
      "max": 1.0,
      "step": 0.1,
      "default": 0.3,
      "label": "Zoom duration",
      "unit": "s"
    },
    {
      "type": "header",
      "content": "Text Settings"
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 12,
      "max": 32,
      "step": 1,
      "default": 18,
      "label": "Text size",
      "unit": "px"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "select",
      "id": "text_weight",
      "label": "Text weight",
      "options": [
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medium" },
        { "value": "600", "label": "Semi Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "500"
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "text_transform",
      "label": "Text transform",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "uppercase", "label": "Uppercase" },
        { "value": "lowercase", "label": "Lowercase" },
        { "value": "capitalize", "label": "Capitalize" }
      ],
      "default": "none"
    },
    {
      "type": "range",
      "id": "text_spacing",
      "min": 0,
      "max": 50,
      "step": 2,
      "default": 0,
      "label": "Top spacing",
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "collection_item",
      "name": "Collection",
      "limit": 4,
      "settings": [
        {
          "type": "collection",
          "id": "collection",
          "label": "Select collection"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text below image",
          "default": "Collection Name"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Collection Grid",
      "blocks": [
        {
          "type": "collection_item"
        },
        {
          "type": "collection_item"
        },
        {
          "type": "collection_item"
        },
        {
          "type": "collection_item"
        }
      ]
    }
  ],
  "max_blocks": 4
}
{% endschema %}
